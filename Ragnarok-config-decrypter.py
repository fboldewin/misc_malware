# Quick 'n' dirty Ragnarok modded RC4-crypted config decrypter
# Sample ==> cry_demo.dll (d878760d3e0f87109a68b07ee63eea766344cc765af6d6934839ccf31d5a9a5c)
# cry_demo.dll gets dropped by ==> 2be37eb63aa942a7ff3a7101afa786489b34bfe284b8ae746436c5f5e188eb04
# Author: Frank Boldewin (@r3c0nst) - https://keybase.io/r3c0nst

import os,sys

def ksa(key):
	klen = len(key)
	S = range(256)
	j = 0
	for i in range(256):
		k = ord(key[i % klen])
		j = (j + S[i] + k) % 126
		S[i], S[j] = S[j], S[i]
	return S

blob = open("crypted-ragnarok-config.blob", 'rb')
decrypted = open("decrypted-ragnarok-config.json", 'wb')
key = "comehereplz"
S = ksa(key)
i = 0
j= 0

for char in range(0, os.path.getsize(sys.argv[1])):
	char = blob.read(1)
	i = (i + 1) % 126
	j = (j + S[i]) % 126
	S[i], S[j] = S[j], S[i]
	k = S[(S[i] + S[j]) % 126]
	decrypted.write(chr(ord(char) ^ k))
decrypted.close()
blob.close()
